<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="./style.css">
   <script src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>
   <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
   <script src="https://unpkg.com/html2canvas@1.4.1/dist/html2canvas.js"></script>
   
    <title>Event Booking Cards</title>
    <style>
    * {
         margin: 0;
         padding: 0;
         box-sizing: border-box;
         font-family: 'Montserrat', sans-serif;
         color: #fff;
      }

  
</style>
</head>
<body>
<div class="container">
          <div class="card" hidden id="event-card">
        <section class="top"></section>
        <div class="event-info">
            <p class="price">80$</p>
            <p class="title">NY Music Festival</p>

            <div class="additional-info">
                <p class="info">
                    <i class="fas fa-map-marker-alt"></i>
                    Palace Theater
                </p>
                <p class="info">
                    <i class="fas fa-calendar-alt"></i>
                    Sat, Sep 19, 10:00 AM
                </p>
            </div>
            <button class="action">Book it</button>
        </div>
    </div>
    <!-- Form for editing event details -->
    <div class="form-section">
        <h2>Edit Event Details</h2>
        <div class="form-input">
            <label for="event-title">Event Title:</label>
            <input type="text" id="event-title" value="NY Music Festival">
        </div>
        <div class="form-input">
            <label for="event-price">Event Price:</label>
            <input type="text" id="event-price" value="80$">
        </div>
        <div class="form-input">
            <label for="event-location">Event Location:</label>
            <input type="text" id="event-location" value="Palace Theater">
        </div>
        <div class="form-input">
            <label for="event-date">Event Date:</label>
            <input type="text" id="event-date" value="Sat, Sep 19, 10:00 AM">
        </div>

        <!-- File Upload or URL Input for Card Background Image -->
        <div class="form-input">
            <label for="event-image">Event Image (Upload or URL):</label>
            <input type="file" id="event-image" accept="image/*">
            <input type="url" id="event-image-url" placeholder="or Image URL">
        </div>
       <!-- Add this button for capturing and sending the card -->
       <button id="captureAndSend">Capture and Send</button>

           <!-- Live Preview Section -->
    <div class="preview-section" id="preview-section" style="background-color: white;">
        <div class="card" id="preview-card" >
            <section class="top"></section>
            <div class="event-info">
                <p class="price" id="preview-price">80$</p>
                <p class="title" id="preview-title">NY Music Festival</p>

                <div class="additional-info">
                    <p class="info">
                        <i class="fas fa-map-marker-alt"></i>
                        Palace Theater
                    </p>
                    <p class="info">
                        <i class="fas fa-calendar-alt"></i>
                        Sat, Sep 19, 10:00 AM
                    </p>
                </div>
                <button class="action">Book it</button>
            </div>
        </div>
    </div>
</div>

    </div>


    <!-- JavaScript to update live preview and card image -->
     <script>
       document.addEventListener('DOMContentLoaded', function() {
        const eventTitleInput = document.getElementById('event-title');
        const eventPriceInput = document.getElementById('event-price');
        const eventLocationInput = document.getElementById('event-location');
        const eventDateInput = document.getElementById('event-date');
        const eventImageInput = document.getElementById('event-image');
        const eventImageUrlInput = document.getElementById('event-image-url');
        const previewTitle = document.getElementById('preview-title');
        const previewPrice = document.getElementById('preview-price');
        const previewLocation = document.querySelector('.preview-section .info:nth-child(1)');
        const previewDate = document.querySelector('.preview-section .info:nth-child(2)');
        const eventCard = document.getElementById('event-card');
        const previewCard = document.getElementById('preview-card');

        eventTitleInput.addEventListener('input', () => {
            previewTitle.textContent = eventTitleInput.value;
        });

        eventPriceInput.addEventListener('input', () => {
            previewPrice.textContent = eventPriceInput.value;
        });

        eventLocationInput.addEventListener('input', () => {
            previewLocation.textContent = eventLocationInput.value;
        });

        eventDateInput.addEventListener('input', () => {
            previewDate.textContent = eventDateInput.value;
        });

        // Function to set the background image of the card
        function setCardBackgroundImage(imageUrl) {
            eventCard.style.backgroundImage = `url('${imageUrl}')`;
            previewCard.style.backgroundImage = `url('${imageUrl}')`;
        }

        // Handle file input change
        eventImageInput.addEventListener('change', (e) => {
            const file = eventImageInput.files[0];
            if (file) {
                const imageUrl = URL.createObjectURL(file);
                setCardBackgroundImage(imageUrl);
            }
        });

        // Handle URL input change
        eventImageUrlInput.addEventListener('input', () => {
            const imageUrl = eventImageUrlInput.value;
            setCardBackgroundImage(imageUrl);
        });
        
        
        
        // Add an event listener to the "Capture and Send" button
document.getElementById('captureAndSend').addEventListener('click', () => {

document.getElementById('preview-section').style.backgroundColor = 'white'; 
  
  setTimeout(() => {
    // Use HTML2Canvas to capture the event card as an image
    html2canvas(document.getElementById('preview-section'),{ allowTaint: true,
            useCORS: true,
            logging: true,
            profile: true,
            backgroundColor: 'white'}).then(canvas => {
    
        // Convert the canvas to a data URL
        const imageDataUrl = canvas.toDataURL('image/jpeg');

       const formData = new FormData();
formData.append('file', imageDataUrl);
formData.append('upload_preset', 'ml_default');

const options = {
  method: 'POST',
  api_key: '272999119546813',
  body: formData,
};

fetch('https://api.cloudinary.com/v1_1/dsjjtnudl/image/upload/', options)
  .then(response => response.json())
  .then(data => {
    // Handle the response from Cloudinary here
    console.log(data);
    
  })
  .catch(error => {
    // Handle errors here
    console.error(error);
        });
      });
      }, 1000);
   });
});      
    </script>
</body>
</html>
